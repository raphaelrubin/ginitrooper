---------------------------------------------
-- CLIENT/ENTITY TAPE EZB DICTIONARY OUTPUT--
---------------------------------------------
-- CI START FOR ALL TAPES
-- Drop View
drop view AMC.TAPE_CLIENT_ENTITY_TASSLER;
-- View erstellen
create or replace view AMC.TAPE_CLIENT_ENTITY_TASSLER as
select distinct
    -- GENERAL
    OSI_ID,
    COUNTRY_ALPHA2 as CNTRY,
    BIRTH_DATE as DT_BRTH,
    DEFAULT_STATUS_DATE as DT_DFLT_STTS,
    FINANCIAL_STATEMENTS_DATE as DT_FNNCL_STTMTS,
    FINANCIAL_STATEMENTS_DATE_LAST_YEAR as DT_FNNCL_STTMTS_PRVS,
    LEGAL_PROCEEDINGS_COUNTERPARTY_INITIATION_DATE as DT_INTTN_LGL_PRCDNGS_LE,
    PERFORMING_STATUS_DATE as DT_PRFRMNG_STTS_LE,
    CUT_OFF_DATE as DT_RFRNC,
    CLIENT_ID as ENTTY_ID,
    PARENT_ENTITY_ID as GCC_PRNT_ID,
    PARENT_ENTITY_NAME as GCC_PRNT_NM,
    SEGMENT_CODE as INTRNL_SGMNT,
    UNIT_CODE as INTRNL_UNT,
    LEGAL_ID as LEI,
    NAME as ENTTY_NM,
    RATING_AGENCY_NAME as EXTRNL_RTNG_NM,
    -- Classification
    ACCOUNTING_FRAMEWORK as ACCNTNG_FRMWRK_SL,
    CURE_FLAG as CR_FLG,
    IS_DECEASED as DCSD,
    DEFAULT_STATUS as DFLT_STTS,
    RATING_EXTERNAL_DATE as DT_EXTRNL_RTNG,
    RATING_INTERNAL_DATE as DT_INTRNL_RTNG,
    NACE_CODE as ECNMC_ACTVTY,
    EMPLOYMENT_STATUS_INTERNAL as EMPLYMNT_STTS_INTRNL,
    EMPLOYMENT_STATUS as EMPLYMNT_STTS,
    ENTERPRISE_SIZE as ENTRPRS_SZ_LE,
    RATING_EXTERNAL as EXTRNL_RTNG,
    RATING_EXTERNAL_LAST_YEAR as EXTRNL_RTNG_PRVS,
    HAS_BANKRUPTCY_IN_GROUP as FLG_BNKRPTCY_IN_GRP,
    FLG_HGH_CDS as FLG_HGH_CDS,
    HAS_ISDA_CREDIT_EVENT as FLG_ISDA_CRDT_EVNT,
    HAS_NON_ACCRUAL_STATUS as FLG_NN_ACCRL,
    HAS_REQUESTED_BANKRUPTCY as FLG_RQST_BNKRPTCY,
    HAS_REQUESTED_CONCESSION as FLG_RQST_DSTRSSD_RSTRCTRNG,
    HAS_REQUESTED_EMERGENCY_FUNDING as FLG_RQST_EMRGNCY_FNDNG,
    HAS_SOLD_WITH_LOSS as FLG_SLL_WTH_LSS,
    INCOME_SELF_CERTIFIED as INCM_SC,
    RATING_INTERNAL as INTRNL_RTNG,
    RATING_INTERNAL_LAST_YEAR as INTRNL_RTNG_PRVS,
    LEGAL_PROCEEDINGS_STATUS as LGL_PRCDNG_STTS_LE,
    OWNED_BY_SPONSOR as OWND_BY_SPNSR,
    PERFORMANCE_STATUS as PRFRMNG_STTS_LE,
    RATING_METHOD as RTNG_MTHD,
    RATING_SCALE as RTNG_SCL,
    IS_ON_WATCH_LIST as WTCH_LST,
    DEBTOR_SPV_TYPE as SNGL_PRPS_VHCL,
    -- Financial Information
    EBITDA_GROUP as GRP_EBITDA,
    EQUITY_GROUP as GRP_EQTY,
    NET_DEBT_GROUP as GRP_NT_DBT,
    ANNUAL_TURNOVER as ANNL_TRNVR_LE,
    ANNUAL_TURNOVER_PREVIOUS as ANNL_TRNVR_PRVS,
    CAPITAL_EXPENDITURES as CAPEX,
    CAPITAL_EXPENDITURES_PREVIOUS as CAPEX_PRVS,
    COLLECTION_MODE as CLLCTN_MD,
    CASH as CSH,
    CASH_PREVIOUS as CSH_PRVS,
    EBITDA as EBITDA,
    EBITDA_PREVIOUS as EBITDA_PRVS,
    EQUITY as EQTY,
    EQUITY_PREVIOUS as EQTY_PRVS,
    Null as FR_CSH_FLW,
    Null as FR_CSH_FLW_T1,
    Null as FR_CSH_FLW_T2,
    Null as FR_CSH_FLW_T3,
    DEBT_GROUP_TOTAL as GRP_TTL_DBT,
    GOODWILL as GDWILL,
    GOODWILL_PREVIOUS as GDWILL_PRVS,
    LOAN_TO_INCOME as LTI,
    LEVERAGE as LVRG,
    LEVERAGE_PREVIOUS as LVRG_PRVS,
    INCOME_OTHER_MONTHLY as MNTHL_INCM,
    INCOME_SALARY_MONTHLY as MNTHL_INCM_SLR,
    TURNOVER_MONTHLY as MNTHL_TRNVR,
    NET_INCOME as NT_INCM,
    NET_INCOME_PREVIOUS as NT_INCM_PRVS,
    DEBT_TOTAL as TTL_DBT,
    DEBT_TOTAL_PREVIOUS as TTL_DBT_PRVS,
    INTEREST_PAID_TOTAL as TTL_INTRST_PD,
    LEVERAGE_RATIO_TOTAL as TTL_LVRG_RT,
    LEVERAGE_RATIO_TOTAL_PREVIOUS as TTL_LVRG_RT_PRVS,
    -- Indicators
    DEBT_REPAYMENT_CAPACITY_SENIOR as DBT_RPYMNT_CPCTY_SNR_DBT,
    DEBT_REPAYMENT_CAPACITY_TOTAL as DBT_RPYMNT_CPCTY_TTL,
    DEBT_SERVICE_COVERING_RATIO as DBT_SRVC_RT,
    DEBT_SERVICE_COVERING_RATIO_PREVIOUS as DBT_SRVC_RT_12M,
    PROBABILITY_OF_DEFAULT_CRR as PD_CRR_RD,
    PROBABILITY_OF_DEFAULT_IFRS9 as PD_IFRS9_12M_RD,
    PROBABILITY_OF_DEFAULT_IFRS9_LAST_YEAR as PD_IFRS9_12M_RD_T1,
    -- Optional
    NULL as ADD_NMRC1,
    NULL as ADD_NMRC2,
    NULL as ADD_NMRC3,
    NULL as ADD_NMRC4,
    NULL as ADD_DT1,
    NULL as ADD_DT2,
    NULL as ADD_DT3,
    NULL as ADD_TXT1, -- length max 255
    NULL as ADD_TXT2, -- length max 255
    NULL as ADD_TXT3  -- length max 255
from AMC.TABLE_CLIENT_ENTITY_CURRENT as TAPE
;
call stg.TEST_PROC_GRANT_PERMISSION_TO('AMC','TAPE_CLIENT_ENTITY_TASSLER');

-- CI END FOR ALL TAPES