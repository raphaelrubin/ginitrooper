----------------------------------------------------
-- FACILITY/INSTRUMENT TAPE EZB DICTIONARY OUTPUT --
----------------------------------------------------
-- CI START FOR ALL TAPES
-- Drop View
drop view AMC.TAPE_FACILITY_INSTRUMENT_TASSLER;
-- View erstellen
create or replace view AMC.TAPE_FACILITY_INSTRUMENT_TASSLER as
select distinct
    -- General
    CUT_OFF_DATE as DT_RFRNC,
    FACILITY_ID as INSTRMNT_ID,
    CONTRACT_ID as CNTRCT_ID,
    CURRENCY as CRRNCY_DNMNTN,
    INCEPTION_DATE as DT_INCPTN,
    OBSERVED_AGENT_ID as OBSRVD_AGNT_ID,
    OBSERVED_AGENT_NAME as OBSRVD_AGNT_NM,
    PRODUCT as PRDCT,
    -- Classification
    BREACHED_COVENANTS as BRCHD_CVNNTS,
    ORIGINATION_CHANNEL as CHNNL_ORGNTN,
    INCLUDES_CASH_SWEEP_OR_TRAP as CSH_SWP_TRP,
    COVENANT_STATUS as CVNNT_STTS,
    COVENANT_TYPE as CVNNT_TYP,
    DEFAULT_STATUS as DFLT_STTS_INSTRMNT,
    DEFAULT_STATUS_DATE as DT_DFLT_STTS_INSTRMNT,
    PRINCIPAL_GRACE_PERIOD_ENDDATE as DT_END_GP_PPAL,
    INTEREST_ONLY_PERIOD_ENDDATE as DT_END_INTRST_ONLY,
    FORBEARANCE_STATUS_DATE as DT_FRBRNC_STTS,
    FORBEARANCE_STATUS_DATE_PREVIOUS as DT_FRBRNC_STTS_PRVS,
    INTERNAL_RATING_DATE as DT_INTRNL_RTNG,
    PERFORMING_STATUS_DATE as DT_PRFRMNG_STTS,
    PERFORMING_STATUS_DATE_PREVIOUS as DT_PRFRMNG_STTS_PRVS,
    INTEREST_ONLY_PERIOD_STARTDATE as DT_STRT_INTRST_ONLY,
    EXPOSURE_IN_SCOPE as EXPSR_IN_SCP,
    FAILED_SYNDICATION as FLD_SYNDCTN,
    LEVERAGE_BUYOUT_FLAG as FLG_LBO,
    FORBEARANCE_STATUS as FRBRNC_STTS_INSTRMNT,
    IMPAIRMENT_STATUS as IMPRMNT_STTS,
    IMPAIRMENT_STATUS_PREVIOUS as IMPRMNT_STTS_PRVS,
    INTERNAL_RATING as INTRNL_RTNG,
    INTERNAL_RATING_AT_INCEPTION as INTRNL_RTNG_INCPTN,
    INTERNAL_SEGMENT_CODE as INTRNL_SGMNT,
    INTERNAL_UNIT_CODE as INTRNL_UNT,
    'N' as LCRE,
    LEGAL_PROCEEDINGS_STATUS as LGL_PRCDNG_STTS,
    DEROGATED_FROM_LENDING_STANDARD as LND_DRGTN,
    PERFORMING_STATUS as PRFRMNG_STTS,
    PERFORMING_STATUS_PREVIOUS as PRFRMNG_STTS_PRVS,
    PROJECT_FINANCE_LOAN as PRJCT_FNNC_LN,
    PURPOSE as PRPS,
    IS_INTEREST_ONLY as PYMNT_INTRST_ONLY,
    RECOURSE as RCRS,
    FOR_REFINANCE_PURPOSE as RFNNC_PRPS,
    FOR_SPECULATIVE_LAND_FINANCING as SPCLTV_LNDNG,
    UNDERWRITTEN_TRANSACTION_STATUS as STTS_UNDRWRTTN_TRNSCTN,
    TRANCH as TRNCH,
    AMORTISATION_TYPE as TYP_AMRTSTN,
    INSTRUMENT_TYPE as TYP_INSTRMNT,
    INTEREST_RATE_TYPE as TYP_INTRST_RT,
    MORTGAGE_TYPE as TYP_MRTGG,
    CRE_OPERATION_TYPE as TYP_CRE_OPRTN,
    PRINCIPAL_GRACE_PERIOD_START_DATE as DT_STRT_GP_PPAL,
    -- Financial Information
    GROSS_CARRYING_AMOUNT as GRSS_CRRYNG_AMNT_INSTRMNT,
    ACCUMULATED_CHANGES_FAIRVALUE_CREDITRISK as ACCMLTD_CHNGS_FV_CR_INSTRMNT, -- sorgt f√ºr SQLSTATE 22018
    ACCOUNTING_CLASSIFICATION as ACCNTNG_CLSSFCTN,
    ACCRUED_INTEREST as ACCRD_INTRST_INSTRMNT,
    AMOUNT_DUE_AT_MATURITY as AMNT_D_AT_MTRTY,
    CREDIT_CONVERSION_FACTOR as CCF,
    COMMITMENT_AMOUNT_INCEPTION as CMMTMNT_INCPTN_INSTRMNT,
    COMMITMENT_AMOUNT as CMMTMNT_INSTRMNT,
    CARRYING_AMOUNT as CRRYNG_AMNT_INSTRMNT,
    DEBT_YIELD as DBT_YLD,
    FINAL_MATURITY_DATE as DT_LGL_FNL_MTRTY,
    NEXT_INTEREST_RATE_RESET_DATE as DT_NXT_INTRST_RT_RST,
    ORIGINAL_MATURITY_DATE as DT_ORGNL_MTRTY,
    BEHAVIOURAL_MATURITY_IFRS9 as IFRS9_BHVRL_MTRTY,
    EXPOSURE_AT_DEFAULT as EAD,
    CREDIT_CONVERSION_FACTOR_IFRS9 as IFRS9_CCF,
    EXPOSURE_AT_DEFAULT_IFRS9 as IFRS9_EAD,
    INSTALMENT_PAYABLE as INSTLMNT_PAY,
    OFF_BALANCE_SHEET_AMOUNT as OFF_BLNC_SHT_AMNT_INSTRMNT,
    OFF_BALANCE_SHEET_AMOUNT_PREVIOUS as OFF_BLNC_SHT_AMNT_INSTRMNT_PRVS,
    OUTSTANDING_NOMINAL_AMOUNT as OTSTNDNG_NMNL_AMNT_INSTRMNT,
    OUTSTANDING_NOMINAL_AMOUNT_PREVIOUS as OTSTNDNG_NMNL_AMNT_INSTRMNT_PRVS,
    OFF_BALANCE_SHEET_PROVISIONS as PRVSNS_OFF_BLNC_SHT,
    PAYMENT_FREQUENCY as PYMNT_FRQNCY,
    RETENTION_SHARE as RTNTN_SHR,
    RWA,
    RWA_METHOD as RWA_MTHD,
    SPONSOR_NAME as SPNSR_NM,
    -- Impairment
    ACCUMULATED_IMPAIRMENT as ACCMLTD_IMPRMNT_INSTRMNT,
    ACCUMULATED_IMPAIRMENT_PREVIOUS as ACCMLTD_IMPRMNT_INSTRMNT_PRVS,
    ACCUMULATED_WRITEOFFS as ACCMLTD_WRTFFS_INSTRMNT,
    EXPOSURE_INARREAR as ARRRS_INSTRMNT,
    EXPOSURE_INARREAR_HIGHEST_12M as ARRRS_INSTRMNT_12M,
    CUMULATED_RECOVERIES_SINCE_DEFAULT as CMLTV_RCVRS_SNC_DFLT_INSTRMNT,
    DAYS_PAST_DUE as DPD,
    DAYS_PAST_DUE_HIGHEST_12M as DPD_12M,
    DAYS_PAST_DUE_HIGHEST_12M_FORBEARANCE as DPD_12M_FRBRNC_STTS,
    DAYS_PAST_DUE_HIGHEST_12M_PERFORMING  as DPD_12M_PRFRMNG_STTS,
    DAYS_PAST_DUE_HIGHEST_24M_FORBEARANCE  as DPD_24M_FRBRNC_STTS,
    DAYS_PAST_DUE_HIGHEST_24M_PERFORMING as DPD_24M_PRFRMNG_STTS,
    DAYS_PAST_DUE_FORBEARANCE as DPD_FRBRNC_STTS,
    DAYS_PAST_DUE_PERFORMING as DPD_PRFRMNG_STTS,
    IMPAIRMENT_STATUS_DATE as DT_IMPRMNT_STTS,
    IMPAIRMENT_STATUS_DATE_PREVIOUS as DT_IMPRMNT_STTS_PRVS,
    PAST_DUE_DATE as DT_PST_D,
    IMPAIRMENT_ASSESSMENT_METHOD as IMPRMNT_ASSSSMNT_MTHD,
    IMPAIRMENT_CALCULATION_METHOD as IMPRMNT_CLCLTN_MTHD,
    FORBEARANCE_NUMBER as NMBR_FRBRNC_MSRS,
    -- Indicators
    CORRELATION_COEFFICIENT as CRRLTN_CFFCNT,
    LGD_IFRS9 as IFRS9_LGD,
    LGD as LGD,
    LTV as LTV,
    LTV_INCEPTION as LTV_INCPTN,
    LTV_NONPERFORMING as LTV_NPE,
    PROBABILITY_OF_DEFAULT_CRR_INCEPTION as PD_CRR_INCPTN,
    PROBABILITY_OF_DEFAULT_CRR as PD_CRR_RD,
    PROBABILITY_OF_DEFAULT_CRR_PREV_YEAR as PD_CRR_RD_T1,
    PROBABILITY_OF_DEFAULT_IFRS9_12M_INCEPTION as PD_IFRS9_12M_INCPTN,
    PROBABILITY_OF_DEFAULT_IFRS9_12M as PD_IFRS9_12M_RD,
    PROBABILITY_OF_DEFAULT_IFRS9_12M_PREV_YEAR as PD_IFRS9_12M_RD_T1,
    PROBABILITY_OF_DEFAULT_IFRS9_LIFETIME_INCEPTION as PD_IFRS9_LFTM_INCPTN,
    PROBABILITY_OF_DEFAULT_IFRS9_RMNNG_LIFETIME_INCEPTION as PD_IFRS9_RMNNG_LFTM_INCPTN,
    PROBABILITY_OF_DEFAULT_IFRS9_RMNNG_LIFETIME as PD_IFRS9_RMNNG_LFTM_RD,
    RATING_METHOD as RTNG_MTHD,
    RATING_SCALE as RTNG_SCL,
    SIGNIFICANT_INCREASE_ASSESSMENT_METHOD as SICR_ASSSSMNT_MTHD,
    -- Interest Rates
    INTEREST_RATE as ANNLSD_AGRD_RT,
    EFFECTIVE_INTEREST_RATE as EIR,
    EFFECTIVE_INTEREST_RATE_INCEPTION as EIR_INCPTN,
    INTEREST_RATE_RESET_FREQUENCY as INTRST_RT_RST_FRQNCY,
    -- Optional
    ADD_NMRC1,
    ADD_NMRC2,
    ADD_NMRC3,
    ADD_NMRC4,
    ADD_DT1,
    ADD_DT2,
    ADD_DT3,
    ADD_TXT1,
    ADD_TXT2,
    ADD_TXT3,
    -- Servicing
    RECEIVED_AMORTIZATION_12M as RCVD_AMRTSTN_12M,
    RECEIVED_AMORTIZATION_24M as RCVD_AMRTSTN_24M,
    RECEIVED_INTEREST_12M as RCVD_INTRST_12M,
    RECEIVED_INTEREST_24M as RCVD_INTRST_24M,
    -- Syndication
    SYNDICATE_LENDER_ROLE as SYNDCT_RL,
    SYNDICATE_AGENT_NAME as SYNDCTD_AGNT,
    SYNDICATED_CONTRACT_ID as SYNDCTD_CNTRCT_ID,
    SYNDICATE_LENDERS_NAMES as SYNDCTD_LNDRS,
    SYNDICATE_SHARE as SYNDCTD_SHR,
    SYNDICATION_TYPE as SYNDCTN_TYP
from AMC.TABLE_FACILITY_INSTRUMENT_CURRENT as TAPE
;
call stg.TEST_PROC_GRANT_PERMISSION_TO('AMC','TAPE_FACILITY_INSTRUMENT_TASSLER');

-- CI END FOR ALL TAPES