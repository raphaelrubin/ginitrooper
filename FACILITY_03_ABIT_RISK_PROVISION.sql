-- ABIT Risikovorsorge Daten

-- View erstellen
drop view CALC.VIEW_FACILITY_ABIT_RISK_PROVISION;
create or replace view CALC.VIEW_FACILITY_ABIT_RISK_PROVISION as
with ABIT_ALL as (
    select CUT_OFF_DATE,
           KUNDENNUMMER,
           case
               when SUBSTR(IDEXTERN, 6, 2) = '13' and SUBSTR(IDEXTERN, 22, 2) = '10'
                   then LEFT(IDEXTERN, 20) || '-20-' || SUBSTR(IDEXTERN, 25, 10)
               else IDEXTERN end as IDEXTERN,
           WAEHRUNG,
           KENNZHK,
           BESTANDEWB,
           DATUMERSTEEWB,
           NIEDERLASSUNG,
           QUELLE,
           BRANCH,
           IFRSMETHODE,
           IFRSMETHODEVJ,
           EWBVORJAHR,
           EWBVORMONAT,
           EWBVORQUARTAL,
           EWBZUFUEHRUNGYTDGESAMT,
           EWBZUFUEHRUNGYTDSALDO,
           EWBZUFUEHRUNGYTDSONST,
           EWBZUFUEHRUNGMTMGESAMT,
           EWBZUFUEHRUNGMTMSALDO,
           EWBZUFUEHRUNGMTMSONST,
           EWBAUFLOESUNGYTDGESAMT,
           EWBAUFLOESUNGYTDSALDO,
           EWBAUFLOESUNGYTDSONST,
           EWBAUFLOESUNGMTMGESAMT,
           EWBAUFLOESUNGMTMSALDO,
           EWBAUFLOESUNGMTMSONST,
           EWBAUSBUCHUNGYTD,
           EWBAUSBUCHUNGMTM,
           UNWINDINGYTD,
           UNWINDINGMTM,
           MANUELLEWB,
           ABSCHREIBVOLLGUVYTD,
           ABSCHREIBVOLLGUVMTM,
           ABSCHREIBTEILGUVYTD,
           ABSCHREIBTEILGUVMTM,
           ABSCHREIBDATUMVOLL,
           ABSCHREIBDATUMTEIL,
           POCIKONTO,
           POCINOMINALBETRURSPR,
           POCINOMINALBETRADJ,
           POCINEUBILDUNG,
           POCIAUFLOESUNG,
           POCIVERBRAUCH
    from NLB.ABIT_RIVO_CURRENT
    union all
    select CUT_OFF_DATE,
           KUNDENNUMMER,
           IDEXTERN,
           WAEHRUNG,
           KENNZHK,
           BESTANDEWB,
           DATUMERSTEEWB,
           NIEDERLASSUNG,
           QUELLE,
           BRANCH,
           IFRSMETHODE,
           IFRSMETHODEVJ,
           EWBVORJAHR,
           EWBVORMONAT,
           EWBVORQUARTAL,
           EWBZUFUEHRUNGYTDGESAMT,
           EWBZUFUEHRUNGYTDSALDO,
           EWBZUFUEHRUNGYTDSONST,
           EWBZUFUEHRUNGMTMGESAMT,
           EWBZUFUEHRUNGMTMSALDO,
           EWBZUFUEHRUNGMTMSONST,
           EWBAUFLOESUNGYTDGESAMT,
           EWBAUFLOESUNGYTDSALDO,
           EWBAUFLOESUNGYTDSONST,
           EWBAUFLOESUNGMTMGESAMT,
           EWBAUFLOESUNGMTMSALDO,
           EWBAUFLOESUNGMTMSONST,
           EWBAUSBUCHUNGYTD,
           EWBAUSBUCHUNGMTM,
           UNWINDINGYTD,
           UNWINDINGMTM,
           MANUELLEWB,
           ABSCHREIBVOLLGUVYTD,
           ABSCHREIBVOLLGUVMTM,
           ABSCHREIBTEILGUVYTD,
           ABSCHREIBTEILGUVMTM,
           ABSCHREIBDATUMVOLL,
           ABSCHREIBDATUMTEIL,
           POCIKONTO,
           POCINOMINALBETRURSPR,
           POCINOMINALBETRADJ,
           POCINEUBILDUNG,
           POCIAUFLOESUNG,
           POCIVERBRAUCH
    from ANL.ABIT_RIVO_CURRENT
),
     ABIT_RIVO as (
         select ABIT.CUT_OFF_DATE,
                PORTFOLIO.CLIENT_ID_ORIG,
                PORTFOLIO.FACILITY_ID,
                ABIT.WAEHRUNG                                             as ORIGINAL_CURRENCY,
                EXCHANGE.RATE_EUR_TO_TARGET                               as EXCHANGE_RATE_EUR2OC,
                ABIT.KENNZHK,
                ABIT.BESTANDEWB                                           as AMOUNT_OC,
                ABIT.BESTANDEWB * EXCHANGE.RATE_TARGET_TO_EUR             as AMOUNT_EUR,
                ABIT.DATUMERSTEEWB                                        as DATE_CREATED,
                ABIT.BRANCH,
                ABIT.QUELLE                                               as SOURCE,
                -- Neu hinzugefügt seit EBA
                ABIT.IFRSMETHODE                                          as IFRSMETHOD,
                ABIT.IFRSMETHODEVJ                                        as IFRSMETHOD_PREV_YEAR,
                ABIT.EWBVORJAHR                                           as AMOUNT_PREV_YEAR_OC,
                ABIT.EWBVORJAHR * EXCHANGE.RATE_TARGET_TO_EUR             as AMOUNT_PREV_YEAR_EUR,
                ABIT.EWBVORMONAT                                          as AMOUNT_PREV_MONTH_OC,
                ABIT.EWBVORMONAT * EXCHANGE.RATE_TARGET_TO_EUR            as AMOUNT_PREV_MONTH_EUR,
                ABIT.EWBVORQUARTAL                                        as AMOUNT_PREV_QUARTER_OC,
                ABIT.EWBVORQUARTAL * EXCHANGE.RATE_TARGET_TO_EUR          as AMOUNT_PREV_QUARTER_EUR,
                ABIT.EWBZUFUEHRUNGYTDGESAMT                               as SUPPLY_FULL_YTD_OC,
                ABIT.EWBZUFUEHRUNGYTDGESAMT * EXCHANGE.RATE_TARGET_TO_EUR as SUPPLY_FULL_YTD_EUR,
                ABIT.EWBZUFUEHRUNGYTDSALDO                                as SUPPLY_BAL_YTD_OC,
                ABIT.EWBZUFUEHRUNGYTDSALDO * EXCHANGE.RATE_TARGET_TO_EUR  as SUPPLY_BAL_YTD_EUR,
                ABIT.EWBZUFUEHRUNGYTDSONST                                as SUPPLY_ELSE_YTD_OC,
                ABIT.EWBZUFUEHRUNGYTDSONST * EXCHANGE.RATE_TARGET_TO_EUR  as SUPPLY_ELSE_YTD_EUR,
                ABIT.EWBZUFUEHRUNGMTMGESAMT                               as SUPPLY_FULL_MTM_OC,
                ABIT.EWBZUFUEHRUNGMTMGESAMT * EXCHANGE.RATE_TARGET_TO_EUR as SUPPLY_FULL_MTM_EUR,
                ABIT.EWBZUFUEHRUNGMTMSALDO                                as SUPPLY_BAL_MTM_OC,
                ABIT.EWBZUFUEHRUNGMTMSALDO * EXCHANGE.RATE_TARGET_TO_EUR  as SUPPLY_BAL_MTM_EUR,
                ABIT.EWBZUFUEHRUNGMTMSONST                                as SUPPLY_ELSE_MTM_OC,
                ABIT.EWBZUFUEHRUNGMTMSONST * EXCHANGE.RATE_TARGET_TO_EUR  as SUPPLY_ELSE_MTM_EUR,
                ABIT.EWBAUFLOESUNGYTDGESAMT                               as LIQUIDATION_FULL_YTD_OC,
                ABIT.EWBAUFLOESUNGYTDGESAMT * EXCHANGE.RATE_TARGET_TO_EUR as LIQUIDATION_FULL_YTD_EUR,
                ABIT.EWBAUFLOESUNGYTDSALDO                                as LIQUIDATION_BAL_YTD_OC,
                ABIT.EWBAUFLOESUNGYTDSALDO * EXCHANGE.RATE_TARGET_TO_EUR  as LIQUIDATION_BAL_YTD_EUR,
                ABIT.EWBAUFLOESUNGYTDSONST                                as LIQUIDATION_ELSE_YTD_OC,
                ABIT.EWBAUFLOESUNGYTDSONST * EXCHANGE.RATE_TARGET_TO_EUR  as LIQUIDATION_ELSE_YTD_EUR,
                ABIT.EWBAUFLOESUNGMTMGESAMT                               as LIQUIDATION_FULL_MTM_OC,
                ABIT.EWBAUFLOESUNGMTMGESAMT * EXCHANGE.RATE_TARGET_TO_EUR as LIQUIDATION_FULL_MTM_EUR,
                ABIT.EWBAUFLOESUNGMTMSALDO                                as LIQUIDATION_BAL_MTM_OC,
                ABIT.EWBAUFLOESUNGMTMSALDO * EXCHANGE.RATE_TARGET_TO_EUR  as LIQUIDATION_BAL_MTM_EUR,
                ABIT.EWBAUFLOESUNGMTMSONST                                as LIQUIDATION_ELSE_MTM_OC,
                ABIT.EWBAUFLOESUNGMTMSONST * EXCHANGE.RATE_TARGET_TO_EUR  as LIQUIDATION_ELSE_MTM_EUR,
                ABIT.EWBAUSBUCHUNGYTD                                     as DEBIT_YTD_OC,
                ABIT.EWBAUSBUCHUNGYTD * EXCHANGE.RATE_TARGET_TO_EUR       as DEBIT_YTD_EUR,
                ABIT.EWBAUSBUCHUNGMTM                                     as DEBIT_MTM_OC,
                ABIT.EWBAUSBUCHUNGMTM * EXCHANGE.RATE_TARGET_TO_EUR       as DEBIT_MTM_EUR,
                ABIT.UNWINDINGYTD                                         as UNWINDING_YTD_OC,
                ABIT.UNWINDINGYTD * EXCHANGE.RATE_TARGET_TO_EUR           as UNWINDING_YTD_EUR,
                ABIT.UNWINDINGMTM                                         as UNWINDING_MTM_OC,
                ABIT.UNWINDINGMTM * EXCHANGE.RATE_TARGET_TO_EUR           as UNWINDING_MTM_EUR,
                ABIT.MANUELLEWB                                           as MANUAL_AMOUNT_OC,
                ABIT.MANUELLEWB * EXCHANGE.RATE_TARGET_TO_EUR             as MANUAL_AMOUNT_EUR,
                ABIT.ABSCHREIBVOLLGUVYTD                                  as WRITE_OFF_FULL_GUV_YTD_OC,
                ABIT.ABSCHREIBVOLLGUVYTD * EXCHANGE.RATE_TARGET_TO_EUR    as WRITE_OFF_FULL_GUV_YTD_EUR,
                ABIT.ABSCHREIBVOLLGUVMTM                                  as WRITE_OFF_FULL_GUV_MTM_OC,
                ABIT.ABSCHREIBVOLLGUVMTM * EXCHANGE.RATE_TARGET_TO_EUR    as WRITE_OFF_FULL_GUV_MTM_EUR,
                ABIT.ABSCHREIBTEILGUVYTD                                  as WRITE_OFF_PART_GUV_YTD_OC,
                ABIT.ABSCHREIBTEILGUVYTD * EXCHANGE.RATE_TARGET_TO_EUR    as WRITE_OFF_PART_GUV_YTD_EUR,
                ABIT.ABSCHREIBTEILGUVMTM                                  as WRITE_OFF_PART_GUV_MTM_OC,
                ABIT.ABSCHREIBTEILGUVMTM * EXCHANGE.RATE_TARGET_TO_EUR    as WRITE_OFF_PART_GUV_MTM_EUR,
                ABIT.ABSCHREIBDATUMVOLL                                   as WRITE_OFF_FULL_DATE,
                ABIT.ABSCHREIBDATUMTEIL                                   as WRITE_OFF_PART_DATE,
                ABIT.POCIKONTO                                            as POCI_ACCOUNT,
                ABIT.POCINOMINALBETRURSPR                                 as POCI_NOMINAL_AMOUNT_ORIG_OC,
                ABIT.POCINOMINALBETRURSPR * EXCHANGE.RATE_TARGET_TO_EUR   as POCI_NOMINAL_AMOUNT_ORIG_EUR,
                ABIT.POCINOMINALBETRADJ                                   as POCI_NOMINAL_AMOUNT_ADJ_OC,
                ABIT.POCINOMINALBETRADJ * EXCHANGE.RATE_TARGET_TO_EUR     as POCI_NOMINAL_AMOUNT_ADJ_EUR,
                ABIT.POCINEUBILDUNG                                       as POCI_REGEN_OC,
                ABIT.POCINEUBILDUNG * EXCHANGE.RATE_TARGET_TO_EUR         as POCI_REGEN_EUR,
                ABIT.POCIAUFLOESUNG                                       as POCI_LIQUIDATION_OC,
                ABIT.POCIAUFLOESUNG * EXCHANGE.RATE_TARGET_TO_EUR         as POCI_LIQUIDATION_EUR,
                ABIT.POCIVERBRAUCH                                        as POCI_CONSUMPTION_OC,
                ABIT.POCIVERBRAUCH * EXCHANGE.RATE_TARGET_TO_EUR          as POCI_CONSUMPTION_EUR
         from ABIT_ALL as ABIT
                  inner join CALC.SWITCH_PORTFOLIO_CURRENT as PORTFOLIO
                             on PORTFOLIO.FACILITY_ID = ABIT.IDEXTERN and PORTFOLIO.CUT_OFF_DATE = ABIT.CUT_OFF_DATE
                  left join IMAP.CURRENCY_MAP as EXCHANGE
                            on (ABIT.WAEHRUNG, ABIT.CUT_OFF_DATE) = (EXCHANGE.ZIEL_WHRG, EXCHANGE.CUT_OFF_DATE)
     ),
     ABIT_RIVO_EWB as ( -- Einzelwertberichtigung/ Bilanziell
         select CUT_OFF_DATE,
                CLIENT_ID_ORIG,
                FACILITY_ID,
                AMOUNT_OC                    as SPECIFIC_PROVISION_AMOUNT_OC,
                AMOUNT_EUR                   as SPECIFIC_PROVISION_AMOUNT_EUR,
                DATE_CREATED                 as SPECIFIC_PROVISION_DATE_CREATED,
                AMOUNT_PREV_YEAR_OC          as SPECIFIC_PROVISION_AMOUNT_PREV_YEAR_OC,
                AMOUNT_PREV_YEAR_EUR         as SPECIFIC_PROVISION_AMOUNT_PREV_YEAR_EUR,
                AMOUNT_PREV_MONTH_OC         as SPECIFIC_PROVISION_AMOUNT_PREV_MONTH_OC,
                AMOUNT_PREV_MONTH_EUR        as SPECIFIC_PROVISION_AMOUNT_PREV_MONTH_EUR,
                AMOUNT_PREV_QUARTER_OC       as SPECIFIC_PROVISION_AMOUNT_PREV_QUARTER_OC,
                SUPPLY_FULL_YTD_OC           as SPECIFIC_PROVISION_SUPPLY_FULL_YTD_OC,
                SUPPLY_FULL_YTD_EUR          as SPECIFIC_PROVISION_SUPPLY_FULL_YTD_EUR,
                SUPPLY_BAL_YTD_OC            as SPECIFIC_PROVISION_SUPPLY_BAL_YTD_OC,
                SUPPLY_BAL_YTD_EUR           as SPECIFIC_PROVISION_SUPPLY_BAL_YTD_EUR,
                SUPPLY_ELSE_YTD_OC           as SPECIFIC_PROVISION_SUPPLY_ELSE_YTD_OC,
                SUPPLY_ELSE_YTD_EUR          as SPECIFIC_PROVISION_SUPPLY_ELSE_YTD_EUR,
                SUPPLY_FULL_MTM_OC           as SPECIFIC_PROVISION_SUPPLY_FULL_MTM_OC,
                SUPPLY_FULL_MTM_EUR          as SPECIFIC_PROVISION_SUPPLY_FULL_MTM_EUR,
                SUPPLY_BAL_MTM_OC            as SPECIFIC_PROVISION_SUPPLY_BAL_MTM_OC,
                SUPPLY_BAL_MTM_EUR           as SPECIFIC_PROVISION_SUPPLY_BAL_MTM_EUR,
                SUPPLY_ELSE_MTM_OC           as SPECIFIC_PROVISION_SUPPLY_ELSE_MTM_OC,
                SUPPLY_ELSE_MTM_EUR          as SPECIFIC_PROVISION_SUPPLY_ELSE_MTM_EUR,
                LIQUIDATION_FULL_YTD_OC      as SPECIFIC_PROVISION_LIQUIDATION_FULL_YTD_OC,
                LIQUIDATION_FULL_YTD_EUR     as SPECIFIC_PROVISION_LIQUIDATION_FULL_YTD_EUR,
                LIQUIDATION_BAL_YTD_OC       as SPECIFIC_PROVISION_LIQUIDATION_BAL_YTD_OC,
                LIQUIDATION_BAL_YTD_EUR      as SPECIFIC_PROVISION_LIQUIDATION_BAL_YTD_EUR,
                LIQUIDATION_ELSE_YTD_OC      as SPECIFIC_PROVISION_LIQUIDATION_ELSE_YTD_OC,
                LIQUIDATION_ELSE_YTD_EUR     as SPECIFIC_PROVISION_LIQUIDATION_ELSE_YTD_EUR,
                LIQUIDATION_FULL_MTM_OC      as SPECIFIC_PROVISION_LIQUIDATION_FULL_MTM_OC,
                LIQUIDATION_FULL_MTM_EUR     as SPECIFIC_PROVISION_LIQUIDATION_FULL_MTM_EUR,
                LIQUIDATION_BAL_MTM_OC       as SPECIFIC_PROVISION_LIQUIDATION_BAL_MTM_OC,
                LIQUIDATION_BAL_MTM_EUR      as SPECIFIC_PROVISION_LIQUIDATION_BAL_MTM_EUR,
                LIQUIDATION_ELSE_MTM_OC      as SPECIFIC_PROVISION_LIQUIDATION_ELSE_MTM_OC,
                LIQUIDATION_ELSE_MTM_EUR     as SPECIFIC_PROVISION_LIQUIDATION_ELSE_MTM_EUR,
                DEBIT_YTD_OC                 as SPECIFIC_PROVISION_DEBIT_YTD_OC,
                DEBIT_YTD_EUR                as SPECIFIC_PROVISION_DEBIT_YTD_EUR,
                DEBIT_MTM_OC                 as SPECIFIC_PROVISION_DEBIT_MTM_OC,
                DEBIT_MTM_EUR                as SPECIFIC_PROVISION_DEBIT_MTM_EUR,
                UNWINDING_YTD_OC             as SPECIFIC_PROVISION_UNWINDING_YTD_OC,
                UNWINDING_YTD_EUR            as SPECIFIC_PROVISION_UNWINDING_YTD_EUR,
                UNWINDING_MTM_OC             as SPECIFIC_PROVISION_UNWINDING_MTM_OC,
                UNWINDING_MTM_EUR            as SPECIFIC_PROVISION_UNWINDING_MTM_EUR,
                MANUAL_AMOUNT_OC             as SPECIFIC_PROVISION_MANUAL_AMOUNT_OC,
                MANUAL_AMOUNT_EUR            as SPECIFIC_PROVISION_MANUAL_AMOUNT_EUR,
                WRITE_OFF_FULL_GUV_YTD_OC    as SPECIFIC_PROVISION_WRITE_OFF_FULL_GUV_YTD_OC,
                WRITE_OFF_FULL_GUV_YTD_EUR   as SPECIFIC_PROVISION_WRITE_OFF_FULL_GUV_YTD_EUR,
                WRITE_OFF_FULL_GUV_MTM_OC    as SPECIFIC_PROVISION_WRITE_OFF_FULL_GUV_MTM_OC,
                WRITE_OFF_FULL_GUV_MTM_EUR   as SPECIFIC_PROVISION_WRITE_OFF_FULL_GUV_MTM_EUR,
                WRITE_OFF_PART_GUV_YTD_OC    as SPECIFIC_PROVISION_WRITE_OFF_PART_GUV_YTD_OC,
                WRITE_OFF_PART_GUV_YTD_EUR   as SPECIFIC_PROVISION_WRITE_OFF_PART_GUV_YTD_EUR,
                WRITE_OFF_PART_GUV_MTM_OC    as SPECIFIC_PROVISION_WRITE_OFF_PART_GUV_MTM_OC,
                WRITE_OFF_PART_GUV_MTM_EUR   as SPECIFIC_PROVISION_WRITE_OFF_PART_GUV_MTM_EUR,
                WRITE_OFF_FULL_DATE          as SPECIFIC_PROVISION_WRITE_OFF_FULL_DATE,
                WRITE_OFF_PART_DATE          as SPECIFIC_PROVISION_WRITE_OFF_PART_DATE,
                POCI_NOMINAL_AMOUNT_ORIG_OC  as SPECIFIC_PROVISION_POCI_NOMINAL_AMOUNT_ORIG_OC,
                POCI_NOMINAL_AMOUNT_ORIG_EUR as SPECIFIC_PROVISION_POCI_NOMINAL_AMOUNT_ORIG_EUR,
                POCI_NOMINAL_AMOUNT_ADJ_OC   as SPECIFIC_PROVISION_POCI_NOMINAL_AMOUNT_ADJ_OC,
                POCI_NOMINAL_AMOUNT_ADJ_EUR  as SPECIFIC_PROVISION_POCI_NOMINAL_AMOUNT_ADJ_EUR,
                POCI_REGEN_OC                as SPECIFIC_PROVISION_POCI_REGEN_OC,
                POCI_REGEN_EUR               as SPECIFIC_PROVISION_POCI_REGEN_EUR,
                POCI_LIQUIDATION_OC          as SPECIFIC_PROVISION_POCI_LIQUIDATION_OC,
                POCI_LIQUIDATION_EUR         as SPECIFIC_PROVISION_POCI_LIQUIDATION_EUR,
                POCI_CONSUMPTION_OC          as SPECIFIC_PROVISION_POCI_CONSUMPTION_OC,
                POCI_CONSUMPTION_EUR         as SPECIFIC_PROVISION_POCI_CONSUMPTION_EUR
         from ABIT_RIVO
         where KENNZHK = 'E'
     ),
     ABIT_RIVO_RST as ( -- Rückstellung/ Außerbilanziell
         select CUT_OFF_DATE,
                CLIENT_ID_ORIG,
                FACILITY_ID,
                AMOUNT_OC                    as LOAN_LOSS_PROVISION_AMOUNT_OC,
                AMOUNT_EUR                   as LOAN_LOSS_PROVISION_AMOUNT_EUR,
                DATE_CREATED                 as LOAN_LOSS_DATE_CREATED,
                AMOUNT_PREV_YEAR_OC          as LOAN_LOSS_PROVISION_AMOUNT_PREV_YEAR_OC,
                AMOUNT_PREV_YEAR_EUR         as LOAN_LOSS_PROVISION_AMOUNT_PREV_YEAR_EUR,
                AMOUNT_PREV_MONTH_OC         as LOAN_LOSS_PROVISION_AMOUNT_PREV_MONTH_OC,
                AMOUNT_PREV_MONTH_EUR        as LOAN_LOSS_PROVISION_AMOUNT_PREV_MONTH_EUR,
                AMOUNT_PREV_QUARTER_OC       as LOAN_LOSS_PROVISION_AMOUNT_PREV_QUARTER_OC,
                SUPPLY_FULL_YTD_OC           as LOAN_LOSS_PROVISION_SUPPLY_FULL_YTD_OC,
                SUPPLY_FULL_YTD_EUR          as LOAN_LOSS_PROVISION_SUPPLY_FULL_YTD_EUR,
                SUPPLY_BAL_YTD_OC            as LOAN_LOSS_PROVISION_SUPPLY_BAL_YTD_OC,
                SUPPLY_BAL_YTD_EUR           as LOAN_LOSS_PROVISION_SUPPLY_BAL_YTD_EUR,
                SUPPLY_ELSE_YTD_OC           as LOAN_LOSS_PROVISION_SUPPLY_ELSE_YTD_OC,
                SUPPLY_ELSE_YTD_EUR          as LOAN_LOSS_PROVISION_SUPPLY_ELSE_YTD_EUR,
                SUPPLY_FULL_MTM_OC           as LOAN_LOSS_PROVISION_SUPPLY_FULL_MTM_OC,
                SUPPLY_FULL_MTM_EUR          as LOAN_LOSS_PROVISION_SUPPLY_FULL_MTM_EUR,
                SUPPLY_BAL_MTM_OC            as LOAN_LOSS_PROVISION_SUPPLY_BAL_MTM_OC,
                SUPPLY_BAL_MTM_EUR           as LOAN_LOSS_PROVISION_SUPPLY_BAL_MTM_EUR,
                SUPPLY_ELSE_MTM_OC           as LOAN_LOSS_PROVISION_SUPPLY_ELSE_MTM_OC,
                SUPPLY_ELSE_MTM_EUR          as LOAN_LOSS_PROVISION_SUPPLY_ELSE_MTM_EUR,
                LIQUIDATION_FULL_YTD_OC      as LOAN_LOSS_PROVISION_LIQUIDATION_FULL_YTD_OC,
                LIQUIDATION_FULL_YTD_EUR     as LOAN_LOSS_PROVISION_LIQUIDATION_FULL_YTD_EUR,
                LIQUIDATION_BAL_YTD_OC       as LOAN_LOSS_PROVISION_LIQUIDATION_BAL_YTD_OC,
                LIQUIDATION_BAL_YTD_EUR      as LOAN_LOSS_PROVISION_LIQUIDATION_BAL_YTD_EUR,
                LIQUIDATION_ELSE_YTD_OC      as LOAN_LOSS_PROVISION_LIQUIDATION_ELSE_YTD_OC,
                LIQUIDATION_ELSE_YTD_EUR     as LOAN_LOSS_PROVISION_LIQUIDATION_ELSE_YTD_EUR,
                LIQUIDATION_FULL_MTM_OC      as LOAN_LOSS_PROVISION_LIQUIDATION_FULL_MTM_OC,
                LIQUIDATION_FULL_MTM_EUR     as LOAN_LOSS_PROVISION_LIQUIDATION_FULL_MTM_EUR,
                LIQUIDATION_BAL_MTM_OC       as LOAN_LOSS_PROVISION_LIQUIDATION_BAL_MTM_OC,
                LIQUIDATION_BAL_MTM_EUR      as LOAN_LOSS_PROVISION_LIQUIDATION_BAL_MTM_EUR,
                LIQUIDATION_ELSE_MTM_OC      as LOAN_LOSS_PROVISION_LIQUIDATION_ELSE_MTM_OC,
                LIQUIDATION_ELSE_MTM_EUR     as LOAN_LOSS_PROVISION_LIQUIDATION_ELSE_MTM_EUR,
                DEBIT_YTD_OC                 as LOAN_LOSS_PROVISION_DEBIT_YTD_OC,
                DEBIT_YTD_EUR                as LOAN_LOSS_PROVISION_DEBIT_YTD_EUR,
                DEBIT_MTM_OC                 as LOAN_LOSS_PROVISION_DEBIT_MTM_OC,
                DEBIT_MTM_EUR                as LOAN_LOSS_PROVISION_DEBIT_MTM_EUR,
                UNWINDING_YTD_OC             as LOAN_LOSS_PROVISION_UNWINDING_YTD_OC,
                UNWINDING_YTD_EUR            as LOAN_LOSS_PROVISION_UNWINDING_YTD_EUR,
                UNWINDING_MTM_OC             as LOAN_LOSS_PROVISION_UNWINDING_MTM_OC,
                UNWINDING_MTM_EUR            as LOAN_LOSS_PROVISION_UNWINDING_MTM_EUR,
                MANUAL_AMOUNT_OC             as LOAN_LOSS_PROVISION_MANUAL_AMOUNT_OC,
                MANUAL_AMOUNT_EUR            as LOAN_LOSS_PROVISION_MANUAL_AMOUNT_EUR,
                WRITE_OFF_FULL_GUV_YTD_OC    as LOAN_LOSS_PROVISION_WRITE_OFF_FULL_GUV_YTD_OC,
                WRITE_OFF_FULL_GUV_YTD_EUR   as LOAN_LOSS_PROVISION_WRITE_OFF_FULL_GUV_YTD_EUR,
                WRITE_OFF_FULL_GUV_MTM_OC    as LOAN_LOSS_PROVISION_WRITE_OFF_FULL_GUV_MTM_OC,
                WRITE_OFF_FULL_GUV_MTM_EUR   as LOAN_LOSS_PROVISION_WRITE_OFF_FULL_GUV_MTM_EUR,
                WRITE_OFF_PART_GUV_YTD_OC    as LOAN_LOSS_PROVISION_WRITE_OFF_PART_GUV_YTD_OC,
                WRITE_OFF_PART_GUV_YTD_EUR   as LOAN_LOSS_PROVISION_WRITE_OFF_PART_GUV_YTD_EUR,
                WRITE_OFF_PART_GUV_MTM_OC    as LOAN_LOSS_PROVISION_WRITE_OFF_PART_GUV_MTM_OC,
                WRITE_OFF_PART_GUV_MTM_EUR   as LOAN_LOSS_PROVISION_WRITE_OFF_PART_GUV_MTM_EUR,
                WRITE_OFF_FULL_DATE          as LOAN_LOSS_PROVISION_WRITE_OFF_FULL_DATE,
                WRITE_OFF_PART_DATE          as LOAN_LOSS_PROVISION_WRITE_OFF_PART_DATE,
                POCI_NOMINAL_AMOUNT_ORIG_OC  as LOAN_LOSS_PROVISION_POCI_NOMINAL_AMOUNT_ORIG_OC,
                POCI_NOMINAL_AMOUNT_ORIG_EUR as LOAN_LOSS_PROVISION_POCI_NOMINAL_AMOUNT_ORIG_EUR,
                POCI_NOMINAL_AMOUNT_ADJ_OC   as LOAN_LOSS_PROVISION_POCI_NOMINAL_AMOUNT_ADJ_OC,
                POCI_NOMINAL_AMOUNT_ADJ_EUR  as LOAN_LOSS_PROVISION_POCI_NOMINAL_AMOUNT_ADJ_EUR,
                POCI_REGEN_OC                as LOAN_LOSS_PROVISION_POCI_REGEN_OC,
                POCI_REGEN_EUR               as LOAN_LOSS_PROVISION_POCI_REGEN_EUR,
                POCI_LIQUIDATION_OC          as LOAN_LOSS_PROVISION_POCI_LIQUIDATION_OC,
                POCI_LIQUIDATION_EUR         as LOAN_LOSS_PROVISION_POCI_LIQUIDATION_EUR,
                POCI_CONSUMPTION_OC          as LOAN_LOSS_PROVISION_POCI_CONSUMPTION_OC,
                POCI_CONSUMPTION_EUR         as LOAN_LOSS_PROVISION_POCI_CONSUMPTION_EUR
         from ABIT_RIVO
         where KENNZHK = 'R'
     ),
     RISK_PROVISION as (
         select distinct ABIT_RIVO.CUT_OFF_DATE,
                         ABIT_RIVO.CLIENT_ID_ORIG,
                         ABIT_RIVO.FACILITY_ID,
                         ABIT_RIVO.ORIGINAL_CURRENCY,
                         ABIT_RIVO.EXCHANGE_RATE_EUR2OC,
                         ABIT_RIVO.IFRSMETHOD,
                         ABIT_RIVO.IFRSMETHOD_PREV_YEAR,
                         ABIT_RIVO.POCI_ACCOUNT,
                         ABIT_RIVO.BRANCH,
                         ABIT_RIVO.SOURCE,
                         -- Specific provision
                         ABIT_RIVO_EWB.SPECIFIC_PROVISION_AMOUNT_EUR,
                         ABIT_RIVO_EWB.SPECIFIC_PROVISION_AMOUNT_OC,
                         ABIT_RIVO_EWB.SPECIFIC_PROVISION_DATE_CREATED,
                         ABIT_RIVO_EWB.SPECIFIC_PROVISION_AMOUNT_PREV_YEAR_OC,
                         ABIT_RIVO_EWB.SPECIFIC_PROVISION_AMOUNT_PREV_YEAR_EUR,
                         ABIT_RIVO_EWB.SPECIFIC_PROVISION_AMOUNT_PREV_MONTH_OC,
                         ABIT_RIVO_EWB.SPECIFIC_PROVISION_AMOUNT_PREV_MONTH_EUR,
                         ABIT_RIVO_EWB.SPECIFIC_PROVISION_AMOUNT_PREV_QUARTER_OC,
                         ABIT_RIVO_EWB.SPECIFIC_PROVISION_SUPPLY_FULL_YTD_OC,
                         ABIT_RIVO_EWB.SPECIFIC_PROVISION_SUPPLY_FULL_YTD_EUR,
                         ABIT_RIVO_EWB.SPECIFIC_PROVISION_SUPPLY_BAL_YTD_OC,
                         ABIT_RIVO_EWB.SPECIFIC_PROVISION_SUPPLY_BAL_YTD_EUR,
                         ABIT_RIVO_EWB.SPECIFIC_PROVISION_SUPPLY_ELSE_YTD_OC,
                         ABIT_RIVO_EWB.SPECIFIC_PROVISION_SUPPLY_ELSE_YTD_EUR,
                         ABIT_RIVO_EWB.SPECIFIC_PROVISION_SUPPLY_FULL_MTM_OC,
                         ABIT_RIVO_EWB.SPECIFIC_PROVISION_SUPPLY_FULL_MTM_EUR,
                         ABIT_RIVO_EWB.SPECIFIC_PROVISION_SUPPLY_BAL_MTM_OC,
                         ABIT_RIVO_EWB.SPECIFIC_PROVISION_SUPPLY_BAL_MTM_EUR,
                         ABIT_RIVO_EWB.SPECIFIC_PROVISION_SUPPLY_ELSE_MTM_OC,
                         ABIT_RIVO_EWB.SPECIFIC_PROVISION_SUPPLY_ELSE_MTM_EUR,
                         ABIT_RIVO_EWB.SPECIFIC_PROVISION_LIQUIDATION_FULL_YTD_OC,
                         ABIT_RIVO_EWB.SPECIFIC_PROVISION_LIQUIDATION_FULL_YTD_EUR,
                         ABIT_RIVO_EWB.SPECIFIC_PROVISION_LIQUIDATION_BAL_YTD_OC,
                         ABIT_RIVO_EWB.SPECIFIC_PROVISION_LIQUIDATION_BAL_YTD_EUR,
                         ABIT_RIVO_EWB.SPECIFIC_PROVISION_LIQUIDATION_ELSE_YTD_OC,
                         ABIT_RIVO_EWB.SPECIFIC_PROVISION_LIQUIDATION_ELSE_YTD_EUR,
                         ABIT_RIVO_EWB.SPECIFIC_PROVISION_LIQUIDATION_FULL_MTM_OC,
                         ABIT_RIVO_EWB.SPECIFIC_PROVISION_LIQUIDATION_FULL_MTM_EUR,
                         ABIT_RIVO_EWB.SPECIFIC_PROVISION_LIQUIDATION_BAL_MTM_OC,
                         ABIT_RIVO_EWB.SPECIFIC_PROVISION_LIQUIDATION_BAL_MTM_EUR,
                         ABIT_RIVO_EWB.SPECIFIC_PROVISION_LIQUIDATION_ELSE_MTM_OC,
                         ABIT_RIVO_EWB.SPECIFIC_PROVISION_LIQUIDATION_ELSE_MTM_EUR,
                         ABIT_RIVO_EWB.SPECIFIC_PROVISION_DEBIT_YTD_OC,
                         ABIT_RIVO_EWB.SPECIFIC_PROVISION_DEBIT_YTD_EUR,
                         ABIT_RIVO_EWB.SPECIFIC_PROVISION_DEBIT_MTM_OC,
                         ABIT_RIVO_EWB.SPECIFIC_PROVISION_DEBIT_MTM_EUR,
                         ABIT_RIVO_EWB.SPECIFIC_PROVISION_UNWINDING_YTD_OC,
                         ABIT_RIVO_EWB.SPECIFIC_PROVISION_UNWINDING_YTD_EUR,
                         ABIT_RIVO_EWB.SPECIFIC_PROVISION_UNWINDING_MTM_OC,
                         ABIT_RIVO_EWB.SPECIFIC_PROVISION_UNWINDING_MTM_EUR,
                         ABIT_RIVO_EWB.SPECIFIC_PROVISION_MANUAL_AMOUNT_OC,
                         ABIT_RIVO_EWB.SPECIFIC_PROVISION_MANUAL_AMOUNT_EUR,
                         ABIT_RIVO_EWB.SPECIFIC_PROVISION_WRITE_OFF_FULL_GUV_YTD_OC,
                         ABIT_RIVO_EWB.SPECIFIC_PROVISION_WRITE_OFF_FULL_GUV_YTD_EUR,
                         ABIT_RIVO_EWB.SPECIFIC_PROVISION_WRITE_OFF_FULL_GUV_MTM_OC,
                         ABIT_RIVO_EWB.SPECIFIC_PROVISION_WRITE_OFF_FULL_GUV_MTM_EUR,
                         ABIT_RIVO_EWB.SPECIFIC_PROVISION_WRITE_OFF_PART_GUV_YTD_OC,
                         ABIT_RIVO_EWB.SPECIFIC_PROVISION_WRITE_OFF_PART_GUV_YTD_EUR,
                         ABIT_RIVO_EWB.SPECIFIC_PROVISION_WRITE_OFF_PART_GUV_MTM_OC,
                         ABIT_RIVO_EWB.SPECIFIC_PROVISION_WRITE_OFF_PART_GUV_MTM_EUR,
                         ABIT_RIVO_EWB.SPECIFIC_PROVISION_WRITE_OFF_FULL_DATE,
                         ABIT_RIVO_EWB.SPECIFIC_PROVISION_WRITE_OFF_PART_DATE,
                         ABIT_RIVO_EWB.SPECIFIC_PROVISION_POCI_NOMINAL_AMOUNT_ORIG_OC,
                         ABIT_RIVO_EWB.SPECIFIC_PROVISION_POCI_NOMINAL_AMOUNT_ORIG_EUR,
                         ABIT_RIVO_EWB.SPECIFIC_PROVISION_POCI_NOMINAL_AMOUNT_ADJ_OC,
                         ABIT_RIVO_EWB.SPECIFIC_PROVISION_POCI_NOMINAL_AMOUNT_ADJ_EUR,
                         ABIT_RIVO_EWB.SPECIFIC_PROVISION_POCI_REGEN_OC,
                         ABIT_RIVO_EWB.SPECIFIC_PROVISION_POCI_REGEN_EUR,
                         ABIT_RIVO_EWB.SPECIFIC_PROVISION_POCI_LIQUIDATION_OC,
                         ABIT_RIVO_EWB.SPECIFIC_PROVISION_POCI_LIQUIDATION_EUR,
                         ABIT_RIVO_EWB.SPECIFIC_PROVISION_POCI_CONSUMPTION_OC,
                         ABIT_RIVO_EWB.SPECIFIC_PROVISION_POCI_CONSUMPTION_EUR,
                         -- Loan loss provision
                         ABIT_RIVO_RST.LOAN_LOSS_PROVISION_AMOUNT_EUR,
                         ABIT_RIVO_RST.LOAN_LOSS_PROVISION_AMOUNT_OC,
                         ABIT_RIVO_RST.LOAN_LOSS_DATE_CREATED,
                         ABIT_RIVO_RST.LOAN_LOSS_PROVISION_AMOUNT_PREV_YEAR_OC,
                         ABIT_RIVO_RST.LOAN_LOSS_PROVISION_AMOUNT_PREV_YEAR_EUR,
                         ABIT_RIVO_RST.LOAN_LOSS_PROVISION_AMOUNT_PREV_MONTH_OC,
                         ABIT_RIVO_RST.LOAN_LOSS_PROVISION_AMOUNT_PREV_MONTH_EUR,
                         ABIT_RIVO_RST.LOAN_LOSS_PROVISION_AMOUNT_PREV_QUARTER_OC,
                         ABIT_RIVO_RST.LOAN_LOSS_PROVISION_SUPPLY_FULL_YTD_OC,
                         ABIT_RIVO_RST.LOAN_LOSS_PROVISION_SUPPLY_FULL_YTD_EUR,
                         ABIT_RIVO_RST.LOAN_LOSS_PROVISION_SUPPLY_BAL_YTD_OC,
                         ABIT_RIVO_RST.LOAN_LOSS_PROVISION_SUPPLY_BAL_YTD_EUR,
                         ABIT_RIVO_RST.LOAN_LOSS_PROVISION_SUPPLY_ELSE_YTD_OC,
                         ABIT_RIVO_RST.LOAN_LOSS_PROVISION_SUPPLY_ELSE_YTD_EUR,
                         ABIT_RIVO_RST.LOAN_LOSS_PROVISION_SUPPLY_FULL_MTM_OC,
                         ABIT_RIVO_RST.LOAN_LOSS_PROVISION_SUPPLY_FULL_MTM_EUR,
                         ABIT_RIVO_RST.LOAN_LOSS_PROVISION_SUPPLY_BAL_MTM_OC,
                         ABIT_RIVO_RST.LOAN_LOSS_PROVISION_SUPPLY_BAL_MTM_EUR,
                         ABIT_RIVO_RST.LOAN_LOSS_PROVISION_SUPPLY_ELSE_MTM_OC,
                         ABIT_RIVO_RST.LOAN_LOSS_PROVISION_SUPPLY_ELSE_MTM_EUR,
                         ABIT_RIVO_RST.LOAN_LOSS_PROVISION_LIQUIDATION_FULL_YTD_OC,
                         ABIT_RIVO_RST.LOAN_LOSS_PROVISION_LIQUIDATION_FULL_YTD_EUR,
                         ABIT_RIVO_RST.LOAN_LOSS_PROVISION_LIQUIDATION_BAL_YTD_OC,
                         ABIT_RIVO_RST.LOAN_LOSS_PROVISION_LIQUIDATION_BAL_YTD_EUR,
                         ABIT_RIVO_RST.LOAN_LOSS_PROVISION_LIQUIDATION_ELSE_YTD_OC,
                         ABIT_RIVO_RST.LOAN_LOSS_PROVISION_LIQUIDATION_ELSE_YTD_EUR,
                         ABIT_RIVO_RST.LOAN_LOSS_PROVISION_LIQUIDATION_FULL_MTM_OC,
                         ABIT_RIVO_RST.LOAN_LOSS_PROVISION_LIQUIDATION_FULL_MTM_EUR,
                         ABIT_RIVO_RST.LOAN_LOSS_PROVISION_LIQUIDATION_BAL_MTM_OC,
                         ABIT_RIVO_RST.LOAN_LOSS_PROVISION_LIQUIDATION_BAL_MTM_EUR,
                         ABIT_RIVO_RST.LOAN_LOSS_PROVISION_LIQUIDATION_ELSE_MTM_OC,
                         ABIT_RIVO_RST.LOAN_LOSS_PROVISION_LIQUIDATION_ELSE_MTM_EUR,
                         ABIT_RIVO_RST.LOAN_LOSS_PROVISION_DEBIT_YTD_OC,
                         ABIT_RIVO_RST.LOAN_LOSS_PROVISION_DEBIT_YTD_EUR,
                         ABIT_RIVO_RST.LOAN_LOSS_PROVISION_DEBIT_MTM_OC,
                         ABIT_RIVO_RST.LOAN_LOSS_PROVISION_DEBIT_MTM_EUR,
                         ABIT_RIVO_RST.LOAN_LOSS_PROVISION_UNWINDING_YTD_OC,
                         ABIT_RIVO_RST.LOAN_LOSS_PROVISION_UNWINDING_YTD_EUR,
                         ABIT_RIVO_RST.LOAN_LOSS_PROVISION_UNWINDING_MTM_OC,
                         ABIT_RIVO_RST.LOAN_LOSS_PROVISION_UNWINDING_MTM_EUR,
                         ABIT_RIVO_RST.LOAN_LOSS_PROVISION_MANUAL_AMOUNT_OC,
                         ABIT_RIVO_RST.LOAN_LOSS_PROVISION_MANUAL_AMOUNT_EUR,
                         ABIT_RIVO_RST.LOAN_LOSS_PROVISION_WRITE_OFF_FULL_GUV_YTD_OC,
                         ABIT_RIVO_RST.LOAN_LOSS_PROVISION_WRITE_OFF_FULL_GUV_YTD_EUR,
                         ABIT_RIVO_RST.LOAN_LOSS_PROVISION_WRITE_OFF_FULL_GUV_MTM_OC,
                         ABIT_RIVO_RST.LOAN_LOSS_PROVISION_WRITE_OFF_FULL_GUV_MTM_EUR,
                         ABIT_RIVO_RST.LOAN_LOSS_PROVISION_WRITE_OFF_PART_GUV_YTD_OC,
                         ABIT_RIVO_RST.LOAN_LOSS_PROVISION_WRITE_OFF_PART_GUV_YTD_EUR,
                         ABIT_RIVO_RST.LOAN_LOSS_PROVISION_WRITE_OFF_PART_GUV_MTM_OC,
                         ABIT_RIVO_RST.LOAN_LOSS_PROVISION_WRITE_OFF_PART_GUV_MTM_EUR,
                         ABIT_RIVO_RST.LOAN_LOSS_PROVISION_WRITE_OFF_FULL_DATE,
                         ABIT_RIVO_RST.LOAN_LOSS_PROVISION_WRITE_OFF_PART_DATE,
                         ABIT_RIVO_RST.LOAN_LOSS_PROVISION_POCI_NOMINAL_AMOUNT_ORIG_OC,
                         ABIT_RIVO_RST.LOAN_LOSS_PROVISION_POCI_NOMINAL_AMOUNT_ORIG_EUR,
                         ABIT_RIVO_RST.LOAN_LOSS_PROVISION_POCI_NOMINAL_AMOUNT_ADJ_OC,
                         ABIT_RIVO_RST.LOAN_LOSS_PROVISION_POCI_NOMINAL_AMOUNT_ADJ_EUR,
                         ABIT_RIVO_RST.LOAN_LOSS_PROVISION_POCI_REGEN_OC,
                         ABIT_RIVO_RST.LOAN_LOSS_PROVISION_POCI_REGEN_EUR,
                         ABIT_RIVO_RST.LOAN_LOSS_PROVISION_POCI_LIQUIDATION_OC,
                         ABIT_RIVO_RST.LOAN_LOSS_PROVISION_POCI_LIQUIDATION_EUR,
                         ABIT_RIVO_RST.LOAN_LOSS_PROVISION_POCI_CONSUMPTION_OC,
                         ABIT_RIVO_RST.LOAN_LOSS_PROVISION_POCI_CONSUMPTION_EUR
         from ABIT_RIVO
                  left join ABIT_RIVO_EWB on (ABIT_RIVO_EWB.FACILITY_ID, ABIT_RIVO_EWB.CUT_OFF_DATE) =
                                             (ABIT_RIVO.FACILITY_ID, ABIT_RIVO.CUT_OFF_DATE)
                  left join ABIT_RIVO_RST on (ABIT_RIVO_RST.FACILITY_ID, ABIT_RIVO_RST.CUT_OFF_DATE) =
                                             (ABIT_RIVO.FACILITY_ID, ABIT_RIVO.CUT_OFF_DATE)
     )
select *,
       Current_USER      as CREATED_USER,     -- Letzter Nutzer, der diese Tabelle gebaut hat.
       Current_TIMESTAMP as CREATED_TIMESTAMP -- Neuester Zeitstempel, wann diese Tabelle zuletzt gebaut wurde.
from RISK_PROVISION
;

-- CI START FOR ALL TAPES
-- Current-Tabelle erstellen
call STG.TEST_PROC_BACKUP_AND_DROP('AMC', 'TABLE_FACILITY_ABIT_RISK_PROVISION_CURRENT');
create table AMC.TABLE_FACILITY_ABIT_RISK_PROVISION_CURRENT like CALC.VIEW_FACILITY_ABIT_RISK_PROVISION distribute by hash (FACILITY_ID) in SPACE_AMC_A,SPACE_AMC_B,SPACE_AMC_C,SPACE_AMC_D,SPACE_AMC_E,SPACE_AMC_F;
create index AMC.INDEX_FACILITY_ABIT_RISK_PROVISION_CURRENT_FACILITY_ID on AMC.TABLE_FACILITY_ABIT_RISK_PROVISION_CURRENT (FACILITY_ID);
call STG.TEST_PROC_LOAD_AND_DROP_BACKUP_FOR('AMC', 'TABLE_FACILITY_ABIT_RISK_PROVISION_CURRENT');
-- Archiv-Tabelle erstellen
call STG.TEST_PROC_BACKUP_AND_DROP('AMC', 'TABLE_FACILITY_ABIT_RISK_PROVISION_ARCHIVE');
create table AMC.TABLE_FACILITY_ABIT_RISK_PROVISION_ARCHIVE like AMC.TABLE_FACILITY_ABIT_RISK_PROVISION_CURRENT distribute by hash (FACILITY_ID) partition by RANGE (CUT_OFF_DATE) (starting '1.1.2020' ending '31.12.2030' EVERY 1 Month) in SPACE_AMC_A,SPACE_AMC_B,SPACE_AMC_C,SPACE_AMC_D,SPACE_AMC_E,SPACE_AMC_F;
create index AMC.INDEX_FACILITY_ABIT_RISK_PROVISION_ARCHIVE_FACILITY_ID on AMC.TABLE_FACILITY_ABIT_RISK_PROVISION_ARCHIVE (FACILITY_ID);
call STG.TEST_PROC_LOAD_AND_DROP_BACKUP_FOR('AMC', 'TABLE_FACILITY_ABIT_RISK_PROVISION_ARCHIVE');
-- CI END FOR ALL TAPES

-- SWITCH View erstellen
call STG.TEST_PROC_DROP_AND_CREATE_SWITCH('AMC', 'TABLE_FACILITY_ABIT_RISK_PROVISION_CURRENT');
call STG.TEST_PROC_DROP_AND_CREATE_SWITCH('AMC', 'TABLE_FACILITY_ABIT_RISK_PROVISION_ARCHIVE');
