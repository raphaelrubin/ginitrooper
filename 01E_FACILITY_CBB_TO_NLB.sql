------------------------------------------------------------------------------------------------------------------------
/* Portfolio FACILITY_CBB_TO_NLB
 *
 * Portfolio ist die Basis für alle AMC Tapes bestehend aus KR Zulieferung und SPOT Erweiterung. Hier stehen Kunden und
 * Konten, welche für AMC relevant sind, also alle Konten von Kunden aus dem Bereich Schiffe/Flugzeuge. Hier wurden auch
 * alternative Kunden- und Kontennummern gesammelt.
 *
 * VIEW_FACILITY_CBB_TO_NLB ist ein manuelles Mapping von Luxemburg CBB Facility IDs zu NLB Facility IDs.
 *
 * Es gibt mehrere PORTFOLIO_PRE Dateien, in denen sich manuell befüllte Views befinden. Diese müssen manuell
 * aktualisiert werden. Die Reihenfolge zum Ausführen ist:
 *
 * 1) PORTFOLIO_PRE Dateien:
 *   - SURROGATE
 *   - FACILITY_CBB_TO_NLB
 *   - CLIENT_CBB_TO_NLB
 * 2) BW_STAMMDATEN
 * 3) PORTFOLIO
 */
------------------------------------------------------------------------------------------------------------------------

-- VIEW erstellen
------------------------------------------------------------------------------------------------------------------------
drop view CALC.VIEW_FACILITY_CBB_TO_NLB;
create or replace view CALC.VIEW_FACILITY_CBB_TO_NLB as
with
    LUX_TO_NLB(FACILITY_ID_CBB, FACILITY_ID_NLB,VALID_FROM, VALID_TO) as (
        select * from TABLE(VALUES
            ('K028-2218714_1020','0009-33-004250046480-31-0000000000','2018-12-31','9999-12-31'),
            ('K028-2229110_1020','0009-33-004250157090-31-0000000000','2018-12-31','9999-12-31'),
            ('K028-2361861_1020','0009-33-004250097270-31-0000000000','2018-12-31','9999-12-31'),
            ('K028-2363741_1020','0009-33-004250081340-31-0000000000','2018-12-31','9999-12-31'),
            ('K028-2369299_1020','0009-33-004250082890-31-0000000000','2018-12-31','9999-12-31'),
            ('K028-2413459_1020','0009-33-004250107260-31-0000000000','2018-12-31','9999-12-31'),
            ('K028-2413461_1020','0009-33-004250107530-31-0000000000','2018-12-31','9999-12-31'),
            ('K028-2419897_1020','0009-49-001800038125-20-0000000000','2018-12-31','9999-12-31'),
            ('K028-2457568_1020','0009-49-001802300157-20-0000000000','2019-06-30','9999-12-31'),
            --('K028-2493008_1020','n.a.','2019-06-30','2019-06-30'),
            ('K028-2516795_1020','0009-33-004250136840-31-0000000000','2018-12-31','9999-12-31'),
            ('K028-2517627_1020','0009-33-004250137430-31-0000000000','2018-12-31','2018-12-31'),
            ('K028-2517627_4200','0009-33-004230003210-21-0000000000','2018-12-31','2018-12-31'),
            ('K028-2557688_1020','K028-2557688_1020','2018-12-31','2018-12-31'),
            ('K028-2570555_1020','0009-33-004250145810-31-0000000000','2018-12-31','9999-12-31'),
            ('K028-2588653_1020','0009-33-004250149220-31-0000000000','2018-12-31','9999-12-31'),
            --('K028-2640639_1020','n.a.','2019-06-30','2019-06-30'),
            --('K028-2643122_1020','0009-73-004533008737-10-0000000000','2018-12-31','2018-12-31'),
            --('K028-2643125_1020','0009-73-004533008734-10-0000000000','2018-12-31','2018-12-31'),
            ('K028-2662067_1020','0009-49-001800064328-20-0000000000','2019-06-30','9999-12-31'),
            ('K028-2643158_1020','0009-49-001800064356-20-0000000000','2019-06-30','9999-12-31'),
            ('K028-2643443_1020','0009-49-001800063746-20-0000000000','2019-06-30','9999-12-31'),
            ('K028-2643445_1020','0009-49-001800063752-20-0000000000','2019-06-30','9999-12-31'),
            ('K028-2643449_1020','0009-49-001800063730-20-0000000000','2019-06-30','9999-12-31'),
            ('K028-2643451_1020','0009-49-001800063765-20-0000000000','2019-06-30','9999-12-31'),
            ('K028-2643455_1020','0009-49-001800063806-20-0000000000','2019-06-30','9999-12-31'),
            ('K028-2643457_1020','0009-49-001800063771-20-0000000000','2019-06-30','9999-12-31'),
            ('K028-2643459_1020','0009-49-001800063815-20-0000000000','2019-06-30','9999-12-31'),
            ('K028-2643461_1020','0009-49-001800063787-20-0000000000','2019-06-30','9999-12-31'),
            ('K028-2643463_1020','0009-49-001800063793-20-0000000000','2019-06-30','9999-12-31'),
            ('K028-2643465_1020','0009-49-001800063837-20-0000000000','2019-06-30','9999-12-31'),
            ('K028-2643467_1020','0009-49-001800063821-20-0000000000','2019-06-30','9999-12-31'),
            ('K028-2643469_1020','0009-49-001800063843-20-0000000000','2019-06-30','9999-12-31'),
            --('K028-2644132_1020','n.a.','2019-06-30','2019-06-30'),
            ('K028-2644270_1020','0009-49-001800064356-20-0000000000','2019-06-30','9999-12-31'),
            ('K028-2655293_1020','0009-49-001800063540-20-0000000000','2019-06-30','9999-12-31'),

            ('K028-2662069_1020','0009-49-001800064328-20-0000000000','2019-06-30','9999-12-31'),
            ('K028-2666000_1020','0009-33-004250169310-31-0000000000','2018-12-31','9999-12-31'),
            ('K028-2670959_1020','0009-49-001800063608-20-0000000000','2018-12-31','9999-12-31'),
            ('K028-2677196_4200','0009-73-004533706150-10-0000000000','2018-12-31','2018-12-31'),
            ('K028-2680455_1020','0009-49-001800064340-20-0000000000','2019-06-30','9999-12-31'),
            ('K028-2680457_1020','0009-49-001800064340-20-0000000000','2019-06-30','9999-12-31'),
            ('K028-2690187_1020','0009-49-001800064334-20-0000000000','2019-06-30','9999-12-31'),
            ('K028-2690193_1020','0009-49-001800064334-20-0000000000','2019-06-30','9999-12-31'),
            --('K028-2691376_1020','n.a.','2019-06-30','2019-06-30'),
            --('K028-2691424_1020','n.a.','2019-06-30','2019-06-30'),
            ('K028-2696596_1020','0009-49-001802300157-20-0000000000','2019-06-30','9999-12-31'),
            ('K028-2699660_1020','0009-49-001800064488-20-0000000000','2019-06-30','9999-12-31'),
            ('K028-2704161_1020','0009-49-001802300157-20-0000000000','2019-06-30','9999-12-31')
        )
    )
select * from LUX_TO_NLB
;
------------------------------------------------------------------------------------------------------------------------

