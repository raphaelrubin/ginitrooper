------------------------------------------------------------------------------------------------------------------------
/* Portfolio CLIENT_CBB_TO_NLB
 *
 * Portfolio ist die Basis für alle AMC Tapes bestehend aus KR Zulieferung und SPOT Erweiterung. Hier stehen Kunden und
 * Konten, welche für AMC relevant sind, also alle Konten von Kunden aus dem Bereich Schiffe/Flugzeuge. Hier wurden auch
 * alternative Kunden- und Kontennummern gesammelt.
 *
 * VIEW_CLIENT_CBB_TO_NLB ist ein manuelles Mapping von Luxemburg CBB Kundennummern zu NLB Kundennummern.
 *
 * Es gibt mehrere PORTFOLIO_PRE Dateien, in denen sich manuell befüllte Views befinden. Diese müssen manuell
 * aktualisiert werden. Die Reihenfolge zum Ausführen ist:
 *
 * 1) PORTFOLIO_PRE Dateien:
 *   - SURROGATE
 *   - FACILITY_CBB_TO_NLB
 *   - CLIENT_CBB_TO_NLB
 * 2) BW_STAMMDATEN
 * 3) PORTFOLIO
 */
------------------------------------------------------------------------------------------------------------------------


-- VIEW erstellen
------------------------------------------------------------------------------------------------------------------------
drop view CALC.VIEW_CLIENT_CBB_TO_NLB;
create or replace view CALC.VIEW_CLIENT_CBB_TO_NLB as
    with LUX_CUST_TO_CUST(CLIENT_NO_CBB, CLIENT_NO_NLB,VALID_FROM_DATE) as (
        select * from TABLE(VALUES
            (1115272, 80093851,'30.06.2019'),
            (1115574, 80094911,'30.06.2019'),
            (1119707, 80103362,'30.06.2019'),
            (1119821, 80103367,'30.06.2019'),
            (1107253, 7729086,'30.06.2019'),
            (1122147, 80092891,'30.06.2019'),
            --(81122147,80092891,'31.12.2018'), doppelter, falscher Datensatz (CBB Kundennummer ist 7-stellig)
            (1124751, 80115496,'30.06.2019'),
            (1127599, 80124453,'30.06.2019'),
            (1124573, 80108080,'31.12.2018'),
            (1128251, 80124454,'30.06.2019'),
            (1129567, 80129174,'30.06.2019'),
            (1122376, 8043891,'30.06.2019'),
--             (1123038, 80125138,'30.06.2019'),  -- Kunde falsch zugeordnet
            (1123038, 80105976,'30.06.2019'), -- Richtiger Kunde laut SPOT
            (1123020, 80104673,'30.06.2019'),
            (1127181, 80120299,'30.06.2019'),
            (1127190, 80120301,'30.06.2019'),
            (1127173, 80120303,'30.06.2019'),
            (1127157, 80120304,'30.06.2019'),
            (1127343, 80120306,'30.06.2019'),
            (1127203, 80120309,'30.06.2019'),
            (1127246, 80120310,'30.06.2019'),
            (1127211, 80120312,'30.06.2019'),
            (1127220, 80120330,'30.06.2019'),
            (1127301, 80120331,'30.06.2019'),
            (1127238, 80120332,'30.06.2019'),
            (1127441, 80120334,'30.06.2019'),
            (1127513, 8437103,'30.06.2019'),
            (1127807, 80117879,'30.06.2019'),
            (1127122, 80117218,'30.06.2019'),
            (1122996, 80104675,'30.06.2019'),
            (1123011, 80104678,'30.06.2019'),
            (1127815, 80117883,'30.06.2019'),
            (1122376, 8043891,'30.06.2019'),
            (1123038, 80125138,'30.06.2019'),
            (1123038, 80125138,'30.06.2019'),
            (1123020, 80104673,'30.06.2019'),
            (1127513, 8437103,'30.06.2019'),
            (1123020, 80104673,'30.06.2019'),
            (1123003, 80104669,'30.06.2019'),
            (1123003, 80104669,'30.06.2019'),
            (1122996, 80104675,'30.06.2019'),
            (1122996, 80104675,'30.06.2019'),
            (1123011, 80104678,'30.06.2019'),
            (1123011, 80104678,'30.06.2019'),
            (1127815, 80117883,'30.06.2019'),
            (1127815, 80117883,'30.06.2019'),
            (1122376, 8043891,'30.06.2019'),
            (1122376, 8043891,'30.06.2019'),
            (1127823,80117884,'31.03.2019'),
            (1119529,80104292,'30.09.2019'),
            (1107253,7729086,'31.12.2018'),
            (1127599,80124453,'31.12.2018'),
            (1127599,80124453,'31.12.2018'),
            (1127807,80117879,'31.12.2018'),
            (1127807,80117879,'31.12.2018')
        )
    )
select * from LUX_CUST_TO_CUST
;
------------------------------------------------------------------------------------------------------------------------
